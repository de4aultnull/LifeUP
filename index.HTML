<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LifeUp - Hub</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center h-screen">

  <audio id="bgMusic" loop autoplay>
    <source src="https://www.bensound.com/bensound-music/bensound-dreams.mp3" type="audio/mpeg" />
  </audio>

  <div id="app" class="text-center space-y-6">
    <h1 class="text-4xl font-bold">Bienvenue sur <span class="text-yellow-400">LifeUp</span></h1>
    <div id="g_id_signin"></div>
    <div id="profile" class="hidden space-y-2">
      <img id="user-pic" class="w-20 h-20 rounded-full mx-auto" />
      <h2 id="user-name" class="text-2xl font-semibold"></h2>
      <p id="user-email" class="text-sm text-gray-400"></p>
    </div>
  </div>

  <script>
    window.onload = () => {
      google.accounts.id.initialize({
        client_id: "944469105005-i40nau1ghf55gdpbldfq0nhkroev700h.apps.googleusercontent.com",
        callback: handleCredentialResponse
      });
      google.accounts.id.renderButton(
        document.getElementById("g_id_signin"),
        { theme: "outline", size: "large" }
      );
    };

    function handleCredentialResponse(response) {
      const data = parseJwt(response.credential);
      document.getElementById("user-pic").src = data.picture;
      document.getElementById("user-name").innerText = data.name;
      document.getElementById("user-email").innerText = data.email;
      document.getElementById("profile").classList.remove("hidden");
      document.getElementById("g_id_signin").style.display = "none";
    }

    function parseJwt(token) {
      const base64Url = token.split('.')[1];
      const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      const jsonPayload = decodeURIComponent(
        atob(base64)
          .split('')
          .map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))
          .join('')
      );
      return JSON.parse(jsonPayload);
    }
  </script>
</body>
</html>
